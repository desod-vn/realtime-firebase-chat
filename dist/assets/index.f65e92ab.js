var _e=Object.defineProperty;var ae=Object.getOwnPropertySymbols;var Fe=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var je=(e,i,n)=>i in e?_e(e,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[i]=n,he=(e,i)=>{for(var n in i||(i={}))Fe.call(i,n)&&je(e,n,i[n]);if(ae)for(var n of ae(i))Me.call(i,n)&&je(e,n,i[n]);return e};var Oe=(e,i)=>{var n={};for(var r in e)Fe.call(e,r)&&i.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&ae)for(var r of ae(e))i.indexOf(r)<0&&Me.call(e,r)&&(n[r]=e[r]);return n};import{i as et,g as tt,B as nt,a as st,b as rt,K as it,o as lt,c as at,r as a,j as u,d as t,l as ot,e as pe,f as ct,u as ee,h as Pe,F,p as q,C as $,k as me,m as fe,n as ge,T as dt,I as xe,q as se,W as be,s as re,S as Y,t as X,L as oe,H as Ie,v as ut,E as ce,w as ie,_ as ht,x as ye,y as pt,N as Te,z as mt,R as ft,A as Ne,D as gt,G as xt}from"./vendor.44f88d0a.js";const bt=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}};bt();const U="/default-avatar.png",we=e=>`https://apoqrsgtqq.cloudimg.io/${e}`,yt="https://cdn.jsdelivr.net/gh/naptestdev/zalo-stickers/data/favourite.json",Le={Like:{icon:"/reactions-icon/like.svg",gif:"/reactions/like.gif"},Love:{icon:"/reactions-icon/love.svg",gif:"/reactions/love.gif"},Care:{icon:"/reactions-icon/care.svg",gif:"/reactions/care.gif"},Haha:{icon:"/reactions-icon/haha.svg",gif:"/reactions/haha.gif"},Wow:{icon:"/reactions-icon/wow.svg",gif:"/reactions/wow.gif"},Sad:{icon:"/reactions-icon/sad.svg",gif:"/reactions/sad.gif"},Angry:{icon:"/reactions-icon/angry.svg",gif:"/reactions/angry.gif"}},Re={"\u{1F62D}":["ToT","T-T","T_T","T.T",":((",":-(("],"\u{1F613}":["'-_-"],"\u{1F61C}":[";p",";-p",";P",";-P"],"\u{1F611}":["-_-"],"\u{1F622}":[":'(",":'-("],"\u{1F61E}":[":(",":-(","=(",")=",":["],"\u{1F610}":[":|",":-|"],"\u{1F61B}":[":P",":-P",":p",":-p","=P","=p"],"\u{1F601}":[":D",":-D","=D",":d",":-d","=d"],"\u{1F617}":[":*",":-*"],"\u{1F607}":["O:)","O:-)"],"\u{1F633}":["O_O","o_o","0_0"],"\u{1F60A}":["^_^","^~^","=)"],"\u{1F620}":[">:(",">:-(",">:o",">:-o",">:O",">:-O"],"\u{1F60E}":["8)","B)","8-)","B-)",":))"],"\u{1F61A}":["-3-"],"\u{1F609}":[";)",";-)"],"\u{1F632}":[":O",":o",":-O",":-o"],"\u{1F623}":[">_<",">.<"],"\u{1F618}":[";*",";-*"],"\u{1F615}":[":/",":-/",":\\",":-\\","=/","=\\"],"\u{1F642}":[":)",":]",":-)","(:","(="],"\u2665":["<3"],"\u{1F602}":[":')"],"\u{1F911}":["$-)"]},$e=/^\p{Extended_Pictographic}$/u,Nt={firebaseConfig:'{"apiKey":"AIzaSyDLpPZpQVytGoGlcuyUGFPTICgMO0IaYbA","authDomain":"vtech-notification.firebaseapp.com","projectId":"vtech-notification","storageBucket":"vtech-notification.appspot.com","messagingSenderId":"573354208754","appId":"1:573354208754:web:fe30e15d16364a53d34f6b","measurementId":"G-W8Z6BMNVF9"}',giphyAPIKey:"AIzaSyDLpPZpQVytGoGlcuyUGFPTICgMO0IaYbA"},_="https://vsofh.vn:8013/api",wt="key=AAAAhX6S7fI:APA91bG49ME9K85FNYrwp3hk6s4EO_39ZFcQxkTdkAbIDEGIl20CpSH3LdZNovoshckni9PX6en28H3Z4TALn21K4wFGkw7qcGQdH6uvF6zGacTPt4cevWJyCriav4g7r-0jcAmHl2Uk",Et="BPgaE03VcrkPyW5282zoqBPsrFyC6_oGHPZrfb5yhpLBSuuTnzeDpUXgCDeIHsP3Xc01Mv-5GWc9b_n21JHaCYk",de=et(JSON.parse(Nt.firebaseConfig));tt(de);const A=nt(de),Ee=st(de),Be=rt(de),vt=async()=>await at(Be,{vapidKey:Et}).then(e=>{e&&localStorage.setItem("pingToken",e)}).catch(e=>console.log("An error occurred while retrieving token. ",e)),kt=()=>new Promise(e=>{lt(Be,i=>{e(i)})}),Ke=(e,i,n)=>{const r=localStorage.getItem("pingToken")||null;i!=r&&fetch("https://fcm.googleapis.com/fcm/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:wt},body:JSON.stringify({notification:{title:"Tin nh\u1EAFn \u0111\u1EBFn",body:e,text:n},to:i})}).catch(s=>console.log(s))};it(A,{forceOwnership:!1});const te=({isOpened:e,setIsOpened:i,text:n,title:r="",isError:s=!1,duration:o=5e3})=>(a.exports.useEffect(()=>{e&&setTimeout(()=>{i(!1)},o)},[e]),u("div",{className:`fixed top-5 right-5 ${s?"bg-red-500":"bg-[#323232]"} z-[9999] w-[calc(100vw-40px)] max-w-[300px] scale-100 rounded p-4 text-white transition-all duration-300 ${e?"visible scale-100 opacity-100":"invisible scale-50 opacity-0"}`,children:[t("h1",{className:"text-lg font-bold",children:r}),n]})),ve=e=>{const i=e.split("."),n=i.slice(-1)[0],r=i.slice(0,-1).join(".");return`${Date.now()}-${ot(r.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D"))}.${n}`},ke=e=>{const i=new Date(e),n=pe(i),r=new Date;return pe().isSame(n,"date")?n.format("h:mm A"):pe().isSame(n,"week")?n.format("ddd h:mm A"):r.getFullYear()===i.getFullYear()?n.format("MMM DD h:mm A"):n.format("DD MMM YYYY h:mm A")},ze=e=>{const i=/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()!@:%_\+.~#?&\/\/=]*)/gm;return e.split(" ").reduce((r,s)=>(i.test(s)?r.push({link:s}):typeof r.slice(-1)[0]=="string"?r=[...r.slice(0,-1),`${r.slice(-1)[0]} ${s}`]:r.push(s),r),[])},P=ct(e=>({currentUser:void 0,setCurrentUser:i=>e({currentUser:i})})),Ct=({conversation:e,setIsOpened:i,setMediaViewOpened:n})=>{const{id:r}=ee(),s=P(f=>f.currentUser),o=Pe(),[l,d]=a.exports.useState(!1),[h,c]=a.exports.useState((e==null?void 0:e.nameGroup)||""),[b,m]=a.exports.useState(!1),[E,p]=a.exports.useState(!1),[x,N]=a.exports.useState(""),[v,T]=a.exports.useState([]),z=a.exports.useRef(null),[L,W]=a.exports.useState(e==null?void 0:e.idMember.map(f=>parseInt(f))),[I,k]=a.exports.useState(""),g=f=>{L.includes(f)?W(L.filter(j=>j!==f)):W([...L,f]),k("")};a.exports.useEffect(()=>{fetch(_+"/NhanVien/GetAllNguoiDung?PageSize=100000&PageIndex=1",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+(s==null?void 0:s.token)}}).then(f=>f.json()).then(f=>{f.success&&T(f.data.data)}).catch(f=>console.log(f))},[]);const C=f=>{f.preventDefault(),!!h.trim()&&(i(!1),q($(A,"room",r),{nameGroup:h.trim()}))},V=()=>{const f=[...L,s==null?void 0:s.id].sort(),O=[...new Set(f)].map(G=>{const K=v==null?void 0:v.find(Z=>(Z==null?void 0:Z.idNguoiDung)==G);return{id:""+(K==null?void 0:K.idNguoiDung),name:K==null?void 0:K.tenNguoiDung,avatar:(K==null?void 0:K.strNguoiDungAnhDinhKem)||null}});i(!1),q($(A,"room",r),{idMember:O.map(G=>""+G.id),nameMember:O.map(G=>G.name),listAvatarMember:O.map(G=>G.avatar),userPing:[]})},H=async f=>{var Z;const j=(Z=f.target.files)==null?void 0:Z[0];if(!j)return;if(!j.type.startsWith("image")){N("File v\u1EEBa ch\u1ECDn kh\xF4ng ph\u1EA3i \u1EA3nh"),p(!0);return}const O=1024*1024*5;if(j.size>O){N("K\xEDch c\u1EE1 \u1EA3nh t\u1ED1i \u0111a l\xE0 5MB"),p(!0);return}const G=me(Ee,ve(j.name));await fe(G,j);const K=await ge(G);i(!1),q($(A,"room",r),{avatarMember:K})},B=()=>{(e==null?void 0:e.hostId)==""+(s==null?void 0:s.id)&&(dt($(A,"room",r)),o("/"))},M=()=>{var j;const f=localStorage.getItem("pingToken")||null;q($(A,"room",r),{idMember:e==null?void 0:e.idMember.filter(O=>O!=""+(s==null?void 0:s.id)),nameMember:e==null?void 0:e.idMember.filter(O=>O!=(s==null?void 0:s.ten)),listAvatarMember:e==null?void 0:e.idMember.filter(O=>O!=(s==null?void 0:s.nguoiDung_AnhDinhKem[0].url)),userPing:f?(j=e==null?void 0:e.userPing)==null?void 0:j.filter(O=>O!=f):e.userPing}),o("/")};return t("div",{onClick:()=>i(!1),className:"animate-fade-in fixed top-0 left-0 z-20 flex h-full w-full items-center justify-center bg-[#00000080] transition-all duration-300",children:u("div",{onClick:f=>f.stopPropagation(),className:"bg-stone-300 mx-2 w-full max-w-[500px] rounded-lg",children:[u("div",{className:"border-dark-lighten flex items-center justify-between border-b py-3 px-3",children:[t("div",{className:"flex-1"}),t("div",{className:"flex flex-1 items-center justify-center",children:t("h1",{className:"whitespace-nowrap text-center text-2xl",children:"C\xE0i \u0111\u1EB7t cu\u1ED9c tr\xF2 chuy\u1EC7n"})}),t("div",{className:"flex flex-1 items-center justify-end",children:t("button",{onClick:()=>i(!1),className:"bg-stone-400 flex h-8 w-8 items-center justify-center rounded-full",children:t("i",{className:"bx bx-x text-2xl"})})})]}),u("div",{className:"flex flex-col items-stretch p-3",children:[(e==null?void 0:e.idMember.length)>2&&u(F,{children:[u("button",{onClick:()=>d(f=>!f),className:"bg-stone-300 flex items-center justify-between gap-3 rounded-lg px-3 py-2 transition duration-300 hover:brightness-125",children:[u("div",{className:"flex items-center gap-3",children:[t("i",{className:"bx bx-edit-alt text-2xl"}),t("span",{children:"\u0110\u1ED5i t\xEAn cu\u1ED9c tr\xF2 chuy\u1EC7n"})]}),t("i",{className:`bx bx-chevron-down text-3xl ${l?"rotate-180":""}`})]}),l&&u("form",{onSubmit:C,className:"my-2 flex gap-3",children:[t("div",{className:"flex-grow",children:t("input",{value:h,onChange:f=>c(f.target.value),className:"border-dark-lighten bg-stone-300 h-full w-full rounded-lg border p-2 outline-none transition duration-300 focus:border-gray-500",type:"text",placeholder:"T\xEAn cu\u1ED9c tr\xF2 chuy\u1EC7n"})}),t("button",{className:"bg-primary flex-shrink-0 rounded px-3 transition duration-300 hover:brightness-110",children:"Thay \u0111\u1ED5i"})]}),u("button",{onClick:()=>m(f=>!f),className:"bg-stone-300 flex items-center gap-3 rounded-lg px-3 py-2 transition duration-300 hover:brightness-125",children:[t("i",{className:"bx bxs-group text-2xl"}),t("span",{children:"Th\xE0nh vi\xEAn cu\u1ED9c tr\xF2 chuy\u1EC7n"})]}),b&&u("div",{children:[u("div",{className:"flex justify-between w-full items-center",children:[t("input",{type:"text",value:I,className:"p-2 text-dark outline-none rounded m-5",placeholder:"T\xEAn ng\u01B0\u1EDDi d\xF9ng",onChange:f=>k(f.target.value)}),t("button",{disabled:L.length<=2,onClick:()=>V(),className:"bg-stone-400 rounded-lg py-2 px-3 transition duration-300 hover:brightness-125 disabled:!brightness-[80%]",children:"C\u1EADp nh\u1EADt"})]}),t("div",{className:"mx-5 bg-neutral-400 h-40 p-2 overflow-y-auto",children:L.map(f=>{const j=v.find(O=>(O==null?void 0:O.idNguoiDung)==f);return u("div",{className:"flex items-center mb-2",children:[t("img",{className:"h-8 w-8 flex-shrink-0 rounded-full object-cover mr-2",src:(j==null?void 0:j.strNguoiDungAnhDinhKem)||U,alt:""}),j.tenNguoiDung]})})}),t("div",{className:"flex h-72 w-full flex-col items-stretch gap-2 overflow-y-auto py-2",children:v&&v.filter(f=>f.idNguoiDung!==(s==null?void 0:s.id)&&(f==null?void 0:f.tenNguoiDung.toLowerCase().includes(I.toLowerCase()))).map((f,j)=>u("div",{onClick:()=>g(f==null?void 0:f.idNguoiDung),className:"hover:bg-stone-400 flex cursor-pointer items-center gap-2 px-5 py-2 transition",children:[t("input",{className:"flex-shrink-0 cursor-pointer",type:"checkbox",checked:L.includes(f==null?void 0:f.idNguoiDung),readOnly:!0}),t("img",{className:"h-8 w-8 flex-shrink-0 rounded-full object-cover",src:(f==null?void 0:f.strNguoiDungAnhDinhKem)||U,alt:""}),t("p",{children:f==null?void 0:f.tenNguoiDung})]},j))})]}),u("button",{onClick:()=>{var f;return(f=z.current)==null?void 0:f.click()},className:"bg-stone-300 flex items-center gap-3 rounded-lg px-3 py-2 transition duration-300 hover:brightness-125",children:[t("i",{className:"bx bx-image-alt text-2xl"}),t("span",{children:"\u0110\u1ED5i \u1EA3nh nh\xF3m"})]}),t("input",{hidden:!0,className:"hidden",ref:z,type:"file",accept:"image/*",onChange:H}),t(te,{isOpened:E,setIsOpened:p,text:x,isError:!0})]}),(e==null?void 0:e.idMember.length)>2&&t("button",{onClick:()=>M(),className:"bg-stone-300 flex items-center justify-between gap-3 rounded-lg px-3 py-2 transition duration-300 hover:brightness-125",children:u("div",{className:"flex items-center gap-3",children:[t("i",{className:"bx bx-log-out text-2xl"}),t("span",{children:"R\u1EDDi cu\u1ED9c tr\xF2 chuy\u1EC7n"})]})}),(e==null?void 0:e.hostId)==""+(s==null?void 0:s.id)&&t("button",{onClick:()=>B(),className:"bg-stone-300 flex items-center justify-between gap-3 rounded-lg px-3 py-2 transition duration-300 hover:brightness-125",children:u("div",{className:"flex items-center gap-3",children:[t("i",{className:"bx bx-x text-2xl"}),t("span",{children:"X\xF3a cu\u1ED9c tr\xF2 chuy\u1EC7n"})]})})]})]})})},Ce=({src:e,isOpened:i,setIsOpened:n})=>u("div",{onClick:()=>n(!1),className:`fixed top-0 left-0 z-20 flex h-full w-full items-center justify-center bg-[#00000080] transition-all duration-300 ${i?"visible opacity-100":"invisible opacity-0"}`,children:[e&&t("img",{onClick:r=>r.stopPropagation(),src:e,className:"h-auto max-h-full w-auto max-w-full"}),t("button",{onClick:()=>n(!1),className:"bg-dark-lighten fixed right-2 top-2 z-30 flex h-10 w-10 items-center justify-center rounded-full text-white transition duration-300 hover:brightness-125",children:t("i",{className:"bx bx-x text-4xl"})})]});let Ge={};const De=(e,i)=>{const[n,r]=a.exports.useState(Ge[e]||null),[s,o]=a.exports.useState(!n),[l,d]=a.exports.useState(!1);return a.exports.useEffect(()=>{const h=xe(i,c=>{r(c),o(!1),d(!1),Ge[e]=c},c=>{console.log(c),r(null),o(!1),d(!0)});return()=>{h()}},[e]),{loading:s,error:l,data:n}},Dt=({src:e})=>{const[i,n]=a.exports.useState(!1);return u(F,{children:[t("img",{onClick:()=>n(!0),className:"h-[100px] w-[100px] cursor-pointer object-cover transition duration-300 hover:brightness-75",src:e,alt:""}),t(Ce,{src:e,isOpened:i,setIsOpened:n})]})},St=()=>{const{id:e}=ee(),{data:i,loading:n,error:r}=De(`images-${e}`,se(Y(A,"conversations",e,"messages"),re("type","==","image"),be("createdAt","desc")));return n||r?t("div",{className:"flex h-80 items-center justify-center",children:t(X,{})}):(i==null?void 0:i.empty)?t("div",{className:"h-80 py-3",children:t("p",{className:"text-center",children:"No image found"})}):t("div",{className:"flex h-80 flex-wrap content-start gap-4 overflow-y-auto overflow-x-hidden p-4",children:i==null?void 0:i.docs.map(s=>t(Dt,{src:s.data().content},s.id))})},At=({setIsOpened:e})=>{var i;(function(s){s[s.images=0]="images",s[s.files=1]="files"})(i||(i={}));const[n,r]=a.exports.useState(0);return t("div",{onClick:()=>e(!1),className:"animate-fade-in fixed top-0 left-0 z-20 flex h-full w-full items-center justify-center bg-[#00000080] transition-all duration-300",children:u("div",{onClick:s=>s.stopPropagation(),className:"bg-dark mx-2 w-full max-w-[500px] rounded-lg",children:[u("div",{className:"border-dark-lighten flex items-center justify-between border-b py-3 px-3",children:[t("div",{className:"flex-1"}),t("div",{className:"flex flex-1 items-center justify-center",children:t("h1",{className:"whitespace-nowrap text-center text-2xl",children:"Xem \u1EA3nh"})}),t("div",{className:"flex flex-1 items-center justify-end",children:t("button",{onClick:()=>e(!1),className:"bg-dark-lighten flex h-8 w-8 items-center justify-center rounded-full",children:t("i",{className:"bx bx-x text-2xl"})})})]}),t("div",{className:"border-dark-lighten flex items-stretch border-b",children:t("button",{onClick:()=>r(0),className:`flex-1 py-2 text-center ${n===0?"bg-dark-lighten":""}`,children:"H\xECnh \u1EA3nh"})}),n===0?t(St,{}):t(F,{})]})})},Ft=({conversation:e})=>{const i=P(h=>h.currentUser),[n,r]=a.exports.useState(!1),[s,o]=a.exports.useState(!1),[l,d]=a.exports.useState(Object);return a.exports.useEffect(()=>{const h=e.idMember.find(c=>c!=(i==null?void 0:i.id));fetch(_+"/User/get-by-id?id="+h,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+(i==null?void 0:i.token)}}).then(c=>c.json()).then(c=>{c.success&&h==c.data.id&&d(c.data)}).catch(c=>console.log(c))},[e]),u(F,{children:[u("div",{className:"border-dark-lighten flex h-20 items-center justify-between border-b px-5",children:[u("div",{className:"flex flex-grow items-center gap-3",children:[t(oe,{to:"/",className:"md:hidden",children:t("i",{className:"bx bxs-chevron-left text-primary text-3xl"})}),e.idMember.length===2?t("img",{title:l==null?void 0:l.ten,style:{width:"40px",height:"40px"},className:"rounded-full object-cover",src:!!(l==null?void 0:l.nguoiDung_AnhDinhKem)&&(l==null?void 0:l.nguoiDung_AnhDinhKem.length)&&(l==null?void 0:l.nguoiDung_AnhDinhKem[0].url)?we(l==null?void 0:l.nguoiDung_AnhDinhKem[0].url):U}):t(F,{children:e.avatarMember?t("img",{className:"h-10 w-10 flex-shrink-0 rounded-full object-cover",src:e.avatarMember,alt:""}):t("div",{className:"relative h-10 w-10 flex-shrink-0"})}),t("p",{className:"font-bold",children:e.idMember.length>2&&e.nameGroup?e.nameGroup:e.nameMember.find(h=>h!==(i==null?void 0:i.ten))})]}),t("button",{onClick:()=>r(!0),children:t("i",{className:"bx bxs-group text-primary text-2xl"})})]}),n&&t(Ct,{setIsOpened:r,conversation:e,setMediaViewOpened:o}),s&&t(At,{setIsOpened:o})]})},Ve=({uid:e,size:i=30})=>{const[n,r]=a.exports.useState(Object),s=P(o=>o.currentUser);return a.exports.useEffect(()=>{fetch(_+"/User/get-by-id?id="+e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+(s==null?void 0:s.token)}}).then(o=>o.json()).then(o=>{o.success&&r(o.data)}).catch(o=>console.log(o))},[]),t("img",{title:n==null?void 0:n.ten,style:{width:i,height:i},className:"rounded-full object-cover",src:!!(n==null?void 0:n.nguoiDung_AnhDinhKem)&&(n==null?void 0:n.nguoiDung_AnhDinhKem.length)&&(n==null?void 0:n.nguoiDung_AnhDinhKem[0].url)?we(n==null?void 0:n.nguoiDung_AnhDinhKem[0].url):U})},le=({children:e,onClickAway:i})=>{const n=a.exports.useRef(null);return a.exports.useEffect(()=>{const r=s=>{n.current&&!n.current.contains(s.target)&&i()};return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[]),t(F,{children:e(n)})},He=({position:e,forwardedRef:i,setIsOpened:n,messageId:r,currentReaction:s})=>{const o=P(d=>d.currentUser),l=d=>{q($(A,"message",r),{[`reactions.${o==null?void 0:o.id}`]:d})};return t("div",{ref:i,className:`bg-dark-lighten animate-fade-in absolute bottom-[calc(100%+5px)] z-[1] flex gap-1 rounded-full p-[6px] shadow ${e==="left"?"left-8":"right-8"}`,children:Object.entries(Le).map(([d,h],c)=>t("div",{className:`${c+1===s?"after:bg-primary relative after:absolute after:left-1/2 after:top-full after:h-[5px] after:w-[5px] after:-translate-x-1/2 after:rounded-full":""}`,children:t("img",{onClick:()=>{c+1===s?l(0):l(c+1),n(!1)},title:d,className:"h-7 w-7 origin-bottom cursor-pointer transition duration-300 hover:scale-[115%]",src:h.gif,alt:""})},d))})},qe=({message:e,position:i})=>t(F,{children:Object.entries(e.reactions).filter(([n,r])=>r).length>0&&u("div",{className:`bg-white border-white absolute top-full flex -translate-y-1/2 cursor-pointer items-center gap-[2px] rounded-lg border px-2 text-sm ${i==="right"?"right-8":i==="left-tab"?"left-[70px]":"left-8"}`,children:[Object.entries(Object.entries(e==null?void 0:e.reactions).reduce((n,[r,s])=>(s&&(n[s]=(n[s]||0)+1),n),{})).sort(([n,r],[s,o])=>r-o).slice(0,3).map(([n,r])=>t("img",{className:"h-3 w-3",src:Object.entries(Le)[Number(n)-1][1].icon,alt:""},n)),t("span",{children:Object.entries(e.reactions).filter(([n,r])=>r).length})]})});let Mt={};const We=(e,i)=>{const[n,r]=a.exports.useState(Mt[e]||null),[s,o]=a.exports.useState(!Boolean(n)),[l,d]=a.exports.useState(!1);return a.exports.useEffect(()=>{const h=xe(i,c=>{r(c),o(!1)},c=>{console.log(c),r(null),o(!1),d(!0)});return()=>{h()}},[e]),{loading:s,error:l,data:n}},Je=({messageId:e})=>{var l,d,h,c;const[i,n]=a.exports.useState(!1),{data:r,loading:s,error:o}=We(`message-${e}`,$(A,"message",e));return s||o?t("div",{className:"h-10 w-20 rounded-lg bg-[#4E4F50]"}):u(F,{children:[t("div",{onClick:()=>{const b=document.querySelector(`#message-${e}`);b?b.scrollIntoView({behavior:"smooth"}):n(!0)},className:"cursor-pointer rounded-lg bg-[#4E4F50] p-2 opacity-60",children:((l=r==null?void 0:r.data())==null?void 0:l.typeMessage)==="text"?t("p",{children:(d=r==null?void 0:r.data())==null?void 0:d.content}):((h=r==null?void 0:r.data())==null?void 0:h.typeMessage)==="image"?"H\xECnh \u1EA3nh":((c=r==null?void 0:r.data())==null?void 0:c.tytypeMessagepe)==="sticker"?"Sticker":"Tin nh\u1EAFn \u0111\xE3 \u0111\u01B0\u1EE3c thu h\u1ED3i"}),t(te,{isOpened:i,setIsOpened:n,text:"Kh\xF4ng th\u1EC3 t\xECm th\u1EA5y tin nh\u1EAFn. Vui l\xF2ng k\xE9o l\xEAn \u0111\u1EC3 ki\u1EC3m tra"})]})},Se=({className:e})=>t("svg",{className:`h-4 w-4 ${e||""}`,fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{d:"m10 7.002v-4.252c0-.301-.181-.573-.458-.691-.276-.117-.599-.058-.814.153l-8.5 8.25c-.146.141-.228.335-.228.538s.082.397.228.538l8.5 8.25c.217.21.539.269.814.153.277-.118.458-.39.458-.691v-4.25h1.418c4.636 0 8.91 2.52 11.153 6.572l.021.038c.134.244.388.39.658.39.062 0 .124-.007.186-.023.332-.085.564-.384.564-.727 0-7.774-6.257-14.114-14-14.248z"})}),ue=o=>{var l=o,{src:e,size:i,runOnHover:n=!1,delay:r=100}=l,s=Oe(l,["src","size","runOnHover","delay"]);const d=a.exports.useRef(null),[h,c]=a.exports.useState(!1),b=a.exports.useRef(null);return a.exports.useEffect(()=>{c(!1);const m=new Image;return m.src=e,m.addEventListener("load",()=>{var x,N;c(!0);let E=Math.ceil(m.width/m.height),p=0;n?((x=d.current)==null||x.addEventListener("mouseenter",()=>{b.current=setInterval(()=>{d.current||clearInterval(b.current),d.current&&(d.current.style.backgroundPosition=`${Math.round(-(p%E+1)*i)}px 50%`),p++},r)}),(N=d.current)==null||N.addEventListener("mouseleave",()=>{b.current&&clearInterval(b.current),p=0,d.current&&(d.current.style.backgroundPosition="0px 50%")})):b.current=setInterval(()=>{d.current||clearInterval(b.current),d.current&&(d.current.style.backgroundPosition=`${Math.round(-(p%E+1)*i)}px 50%`),p++},r)},{once:!0}),()=>{b.current&&clearInterval(b.current)}},[]),t("div",he({ref:d,style:{width:i,height:i,opacity:h?1:0,backgroundImage:`url(${e})`,backgroundSize:"cover"}},s))},jt=({message:e,conversation:i,index:n,docs:r,setReplyInfo:s})=>{var m,E;const[o,l]=a.exports.useState(!1),d=P(p=>p.currentUser),[h,c]=a.exports.useState(!1),b=ke(e.timestamp.seconds?e.timestamp.seconds*1e3:Date.now());return u("div",{id:`message-${e.id}`,children:[t("div",{className:`${i.idMember.length===2?"px-8":"px-[70px]"} -mb-2 flex`,children:!!(e==null?void 0:e.replyTo)&&t(Je,{messageId:e==null?void 0:e.replyTo})}),u("div",{onClick:p=>{p.detail===2&&e.typeMessage!=="removed"&&s(e)},className:`group relative flex items-stretch gap-2 px-8 ${Object.keys((e==null?void 0:e.reactions)||{}).length>0?"mb-2":""}`,children:[i.idMember.length>2&&t("div",{onClick:p=>p.stopPropagation(),className:"h-full py-1",children:t("div",{className:"h-[30px] w-[30px]",children:((E=(m=r[n-1])==null?void 0:m.data())==null?void 0:E.sender)!==e.author&&t(Ve,{uid:e.author})})}),e.typeMessage==="text"?t(F,{children:$e.test(e.content)?t("div",{onClick:p=>p.stopPropagation(),title:b,className:"text-4xl",children:e.content}):t("div",{onClick:p=>p.stopPropagation(),title:b,className:`bg-dark-lighten rounded-lg p-2 text-white ${i.idMember.length===2?"after:border-dark-lighten relative after:absolute after:right-full after:bottom-[6px] after:border-8 after:border-t-transparent after:border-l-transparent":""}`,children:ze(e.content).map((p,x)=>t(a.exports.Fragment,{children:typeof p=="string"?t("span",{children:p}):t("a",{className:"mx-1 inline underline",href:p.link,target:"_blank",rel:"noopener noreferrer",children:p.link})},x))})}):e.typeMessage==="image"?u(F,{children:[t("img",{onClick:p=>{c(!0),p.stopPropagation()},title:b,className:"max-w-[60%] cursor-pointer transition duration-300 hover:brightness-[85%]",src:e.content,alt:""}),t(Ce,{src:e.content,isOpened:h,setIsOpened:c})]}):e.typeMessage==="sticker"?t(ue,{onClick:p=>p.stopPropagation(),title:b,src:e.content,size:130}):t("div",{onClick:p=>p.stopPropagation(),title:b,className:"border-dark-lighten rounded-lg border p-3 text-gray-400",children:"Tin nh\u1EAFn \u0111\xE3 \u0111\u01B0\u1EE3c thu h\u1ED3i"}),e.typeMessage!=="removed"&&u(F,{children:[t("button",{onClick:()=>l(!0),className:"text-lg text-gray-500 opacity-0 transition hover:text-gray-300 group-hover:opacity-100",children:t("i",{className:"bx bx-smile"})}),t("button",{onClick:p=>{s(e),p.stopPropagation()},className:"text-gray-500 opacity-0 transition hover:text-gray-300 group-hover:opacity-100",children:t(Se,{})}),o&&t(le,{onClickAway:()=>l(!1),children:p=>{var x;return t(He,{position:"left",forwardedRef:p,setIsOpened:l,messageId:e.id,currentReaction:((x=e==null?void 0:e.reactions)==null?void 0:x[d==null?void 0:d.id])||0})}})]}),Object.keys(e.reactions||{}).length>0&&t(qe,{message:e,position:i.idMember.length>2?"left-tab":"left"})]})]})},Ot=({message:e,setReplyInfo:i})=>{var c,b;const[n,r]=a.exports.useState(!1),[s,o]=a.exports.useState(!1),l=m=>{q($(A,"message",m),{typeMessage:"removed",content:"",reactions:[]})},d=P(m=>m.currentUser),h=ke(((c=e.timestamp)==null?void 0:c.seconds)?((b=e.timestamp)==null?void 0:b.seconds)*1e3:Date.now());return u("div",{id:`message-${e.id}`,children:[t("div",{className:"-mb-2 flex justify-end px-8",children:!!e.replyTo&&t(Je,{messageId:e.replyTo})}),u("div",{onClick:m=>{m.detail===2&&e.typeMessage!=="removed"&&i(e)},className:`group relative flex flex-row-reverse items-stretch gap-2 px-8 ${Object.keys(e.reactions||{}).length>0?"mb-2":""}`,children:[e.typeMessage==="text"?t(F,{children:$e.test(e.content)?t("div",{onClick:m=>m.stopPropagation(),title:h,className:"text-4xl",children:e.content}):t("div",{onClick:m=>m.stopPropagation(),title:h,className:"bg-primary after:border-primary relative rounded-lg p-2 text-white after:absolute after:left-full after:bottom-[6px] after:border-8 after:border-t-transparent after:border-r-transparent",children:ze(e.content).map((m,E)=>t(a.exports.Fragment,{children:typeof m=="string"?t("span",{children:m}):t("a",{className:"mx-1 inline underline",href:m.link,target:"_blank",rel:"noopener noreferrer",children:m.link})},E))})}):e.typeMessage==="image"?u(F,{children:[t("img",{onClick:m=>{o(!0),m.stopPropagation()},title:h,className:"max-w-[60%] cursor-pointer transition duration-300 hover:brightness-[85%]",src:e.content,alt:""}),t(Ce,{src:e.content,isOpened:s,setIsOpened:o})]}):e.typeMessage==="sticker"?t(ue,{onClick:m=>m.stopPropagation(),title:h,src:e.content,size:130}):t("div",{onClick:m=>m.stopPropagation(),title:h,className:"border-dark-lighten rounded-lg border p-3 text-gray-400",children:"Tin nh\u1EAFn \u0111\xE3 \u0111\u01B0\u1EE3c thu h\u1ED3i"}),e.typeMessage!=="removed"&&u(F,{children:[t("button",{onClick:()=>r(!0),className:"text-lg text-gray-500 opacity-0 transition hover:text-gray-300 group-hover:opacity-100",children:t("i",{className:"bx bx-smile"})}),t("button",{onClick:m=>{i(e),m.stopPropagation()},className:"text-gray-500 opacity-0 transition hover:text-gray-300 group-hover:opacity-100",children:t(Se,{})}),t("button",{onClick:m=>{l(e.id),m.stopPropagation()},className:"text-lg text-gray-500 opacity-0 transition hover:text-gray-300 group-hover:opacity-100",children:t("i",{className:"bx bxs-trash"})}),n&&t(le,{onClickAway:()=>r(!1),children:m=>{var E;return t(He,{position:"right",forwardedRef:m,setIsOpened:r,messageId:e.id,currentReaction:((E=e.reactions)==null?void 0:E[d.id])||0})}}),Object.keys(e.reactions||{}).length>0&&t(qe,{message:e,position:"right"})]})]})]})},Pt=({conversation:e,inputSectionOffset:i,replyInfo:n,setReplyInfo:r})=>{const{id:s}=ee(),o=P(N=>N.currentUser),l=a.exports.useRef(null),[d,h]=a.exports.useState(10),{data:c,loading:b,error:m}=De(`conversation-data-${s}-${d}`,se(Y(A,"message"),re("idRoom","==",s==null?void 0:s.toString()),be("timestamp","asc"),Ie(d)));(()=>{!!(e==null?void 0:e.seen)&&!(e==null?void 0:e.seen.includes(""+(o==null?void 0:o.id)))&&q($(A,"room",s),{seen:[""+(o==null?void 0:o.id),...e==null?void 0:e.seen]})})();const p=a.exports.useRef(c),x=a.exports.useRef(s);return a.exports.useEffect(()=>{p.current=c},[c]),a.exports.useEffect(()=>{x.current=s},[s]),b?t("div",{className:"flex flex-grow items-center justify-center",children:t(X,{})}):m?t("div",{className:"flex-grow",children:t("p",{className:"mt-4 text-center text-gray-400",children:"C\xF3 l\u1ED7i x\u1EA3y ra"})}):(c==null?void 0:c.empty)?t("div",{className:"flex-grow",children:t("p",{className:"mt-4 text-center text-gray-400",children:"Kh\xF4ng th\u1EA5y cu\u1ED9c tr\xF2 chuy\u1EC7n n\xE0o."})}):t(ut,{dataLength:c==null?void 0:c.size,next:()=>h(N=>N+10),inverse:!0,hasMore:(c==null?void 0:c.size)>=d,loader:t("div",{className:"flex justify-center py-3",children:t(X,{})}),style:{display:"flex",flexDirection:"column-reverse",overflow:"auto"},height:`calc(100vh - ${300+i}px)`,children:u("div",{className:"flex flex-col items-stretch gap-3 pt-10 pb-1",children:[c==null?void 0:c.docs.map(N=>he({id:N.id},N.data())).map((N,v)=>t(a.exports.Fragment,{children:N.author===""+(o==null?void 0:o.id)?t(Ot,{replyInfo:n,setReplyInfo:r,message:N}):t(jt,{replyInfo:n,setReplyInfo:r,message:N,index:v,docs:c==null?void 0:c.docs,conversation:e})},N.id)),t("div",{ref:l})]})})},It="modulepreload",Ye={},Tt="/",Lt=function(i,n){return!n||n.length===0?i():Promise.all(n.map(r=>{if(r=`${Tt}${r}`,r in Ye)return;Ye[r]=!0;const s=r.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${o}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":It,s||(l.as="script",l.crossOrigin=""),l.href=r,document.head.appendChild(l),s)return new Promise((d,h)=>{l.addEventListener("load",d),l.addEventListener("error",h)})})).then(()=>i())},Rt=({className:e})=>t("svg",{className:`text-primary h-[24px] w-[24px] ${e||""}`,viewBox:"0 0 512 512",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:u("g",{children:[t("path",{d:"M459.699 316.88L361.864 433.238L355.034 355.382C354.742 352.046 355.052 348.673 355.894 345.532C355.918 345.44 355.918 345.44 355.943 345.347C357.054 341.202 358.97 337.371 361.855 333.987C366.816 328.02 373.947 324.293 381.743 323.618L459.699 316.88Z"}),t("path",{d:"M231.328 369.65C210.375 363.906 190.546 353.704 173.21 339.1C169.153 335.708 168.643 329.588 172.047 325.541C175.441 321.491 181.567 320.986 185.622 324.388C228.777 360.787 289.744 366.032 338.358 337.745C340.341 332.313 343.222 327.241 347.028 322.805C355.209 313.3 366.325 307.284 378.73 306.007C379.278 305.855 379.792 305.794 380.294 305.74L472.247 298.268L454.449 81.8831C453.104 65.6912 438.802 53.5107 422.554 54.9412L94.7977 81.6479C86.9551 82.2795 79.7743 85.901 74.7215 91.981C69.6032 97.934 67.1076 105.613 67.7431 113.456L94.8172 440.863C96.1615 457.054 110.408 469.111 126.609 467.777L343.238 450.162L335.829 360.74C302.694 376.24 265.636 379.042 231.328 369.65V369.65ZM356.868 148.729C376.999 154.123 389.459 175.669 384.073 195.772C378.686 215.874 357.123 228.303 336.991 222.909C316.859 217.515 304.399 195.969 309.786 175.866C315.172 155.764 336.727 143.332 356.868 148.729ZM180.286 236.475C160.154 231.081 147.695 209.535 153.081 189.433C158.468 169.33 180.031 156.901 200.163 162.295C220.294 167.689 232.754 189.235 227.368 209.338C221.981 229.44 200.418 241.87 180.286 236.475Z"})]})});let Ze={};function $t(e,i){const[n,r]=a.exports.useState(Ze[e]||null),[s,o]=a.exports.useState(!n),[l,d]=a.exports.useState(!1);return a.exports.useEffect(()=>{i().then(h=>{Ze[e]=h,r(h),o(!1),d(!1)}).catch(h=>{console.log(h),r(null),o(!1),d(!0)})},[e]),{data:n,loading:s,error:l}}const Bt=()=>{const e=localStorage.getItem("fireverse-recent-stickers")||"[]";try{const i=JSON.parse(e);return Array.isArray(i)?i:[]}catch{return[]}},Kt=({setIsOpened:e,onSelect:i})=>{const{data:n,loading:r,error:s}=$t("sticker",()=>fetch(yt).then(h=>h.json())),[o,l]=a.exports.useState(Bt()),d=h=>{const c=[...new Set([h,...o])];localStorage.setItem("fireverse-recent-stickers",JSON.stringify(c)),l(c)};return t(le,{onClickAway:()=>e(!1),children:h=>t("div",{ref:h,className:"border-dark-lighten absolute -left-16 bottom-full h-96 w-96 rounded-lg border-2 bg-stone-200 shadow-2xl",children:r||s?t("div",{className:"flex h-full w-full items-center justify-center",children:t(X,{})}):u("div",{className:"flex h-full w-full flex-col",children:[u("div",{className:"flex-grow overflow-y-auto p-3 pt-1",children:[o.length>0&&u(F,{children:[t("h1",{className:"mt-2",id:"sticker-recent font-white",children:"S\u1EED d\u1EE5ng g\u1EA7n \u0111\xE2y"}),t("div",{className:"grid w-full grid-cols-5 justify-between",children:o.map(c=>t(ue,{size:60,onClick:()=>{i(c),d(c),e(!1)},className:"hover:bg-dark-lighten cursor-pointer",src:c,runOnHover:!0}))})]}),n==null?void 0:n.map(c=>u(a.exports.Fragment,{children:[t("h1",{className:"mt-2",id:`sticker-${c.id}`,children:c.name}),t("div",{className:"grid w-full grid-cols-5 justify-between",children:c.stickers.map(b=>t(ue,{size:60,onClick:()=>{i(b.spriteURL),d(b.spriteURL),e(!1)},className:"hover:bg-dark-lighten cursor-pointer",src:b.spriteURL,runOnHover:!0},b.spriteURL))})]},c.id))]}),u("div",{className:"h-18 border-t-dark-lighten flex w-full flex-shrink-0 gap-2 overflow-x-auto border-t p-2",children:[o.length>0&&t("button",{onClick:()=>{var c;return(c=document.querySelector("#sticker-recent"))==null?void 0:c.scrollIntoView()},className:"flex h-9 w-9 items-center",children:t("i",{className:"bx bx-time text-[26px] leading-[26px]"})}),n==null?void 0:n.map(c=>t("img",{onClick:()=>{var b;return(b=document.querySelector(`#sticker-${c.id}`))==null?void 0:b.scrollIntoView()},className:"h-9 w-9 cursor-pointer object-cover",src:c.icon,alt:""}))]})]})})})},zt=a.exports.lazy(()=>Lt(()=>import("./EmojiPicker.41275976.js"),["assets/EmojiPicker.41275976.js","assets/vendor.44f88d0a.js","assets/vendor.c1058486.css"])),Gt=({disabled:e,setInputSectionOffset:i,replyInfo:n,tagUser:r,setReplyInfo:s,setTagShow:o,conversation:l})=>{const[d,h]=a.exports.useState(""),[c,b]=a.exports.useState(!1),[m,E]=a.exports.useState([]),[p,x]=a.exports.useState(!1),[N,v]=a.exports.useState(!1),[T,z]=a.exports.useState(!1),[L,W]=a.exports.useState(""),{id:I}=ee(),k=P(y=>y.currentUser),g=a.exports.useRef(null),C=a.exports.useRef(null),[V,H]=a.exports.useState(!1),B=()=>{q($(A,"room",I),{seen:[""+(k==null?void 0:k.id)],timestamp:ie()})};a.exports.useEffect(()=>{const y=()=>{var w;(w=g.current)==null||w.focus()};return window.addEventListener("focus",y),()=>window.removeEventListener("focus",y)},[]),a.exports.useEffect(()=>{var y;(y=g.current)==null||y.focus()},[I]);const M=async y=>{if(y.preventDefault(),m.length>0){E([]);for(let D=0;D<m.length;D++){const S=m[D],R=await fetch(S),J=await R.blob(),ne=new File([J],"image.png",{type:R.headers.get("content-type")});await j(ne)}}else if(c)return;if(!d.trim())return;h("");let w=` ${d} `;Object.entries(Re).map(([D,S])=>{S.forEach(R=>{w=w.split(` ${R} `).join(` ${D} `)})}),await ce(Y(A,"message"),{idRoom:I,author:""+(k==null?void 0:k.id),content:w.trim(),typeMessage:"text",timestamp:ie(),nameFile:"",replyTo:(n==null?void 0:n.id)||""}),s&&s(null),B(),!!l.userPing&&l.userPing.length&&l.userPing.map(D=>Ke((k==null?void 0:k.ten)+": "+w.trim(),D,I)),!!l.userPing&&l.userPing.length&&l.userPing.map(D=>Ke((k==null?void 0:k.ten)+": "+w.trim(),D,I))},f=y=>{ce(Y(A,"message"),{idRoom:I,author:""+(k==null?void 0:k.id),content:y,typeMessage:"sticker",timestamp:ie(),nameFile:""}),B()},j=async y=>{try{const w=1024*1024*20;if(y.size>w){W("K\xEDch th\u01B0\u1EDBc \u1EA3nh t\u1ED1i \u0111a l\xE0 20MB"),z(!0);return}b(!0);const D=me(Ee,ve(y.name));await fe(D,y);const S=await ge(D);ce(Y(A,"message"),{idRoom:I,author:""+(k==null?void 0:k.id),content:S,typeMessage:"image",timestamp:ie(),nameFile:y.name}),b(!1),B()}catch(w){console.log(w),b(!1)}},O=y=>{var D;const w=(D=y.target.files)==null?void 0:D[0];!w||j(w)},G=y=>{var R,J;const w=(R=g.current)==null?void 0:R.selectionStart,D=(J=g.current)==null?void 0:J.selectionEnd,S=d.split("");S.splice(w,D-w,y),h(S.join(""))};a.exports.useEffect(()=>{d.lastIndexOf("@")>-1&&d.lastIndexOf("@")==d.length-1?o&&o(!0):o&&o(!1)},[d]);const K=y=>{if(y.key===" "){if(y.target.selectionStart!==y.target.selectionEnd)return;const w=d.slice(0,y.target.selectionStart).split(" ").slice(-1)[0];if(w.length===0)return;Object.entries(Re).map(([D,S])=>{S.forEach(R=>{if(R===w){const J=d.split("");J.splice(y.target.selectionStart-w.length,w.length,D),h(J.join(""))}})})}};a.exports.useEffect(()=>{r.length>1&&(h(d+r.find(y=>y!="")+" "),o&&o(!1))},[r]),a.exports.useEffect(()=>{if(!!i){if(m.length>0)return i(128);if(n)return i(76);i(0)}},[m.length,n]);const Z=y=>{var S,R;const w=(R=(S=y==null?void 0:y.clipboardData)==null?void 0:S.files)==null?void 0:R[0];if(!w||!w.type.startsWith("image"))return;const D=URL.createObjectURL(w);E([...m,D])};return a.exports.useEffect(()=>{const y=S=>{S.preventDefault(),S.stopPropagation(),H(!1)},w=S=>{S.preventDefault(),S.stopPropagation(),H(!0)},D=async S=>{S.preventDefault(),S.stopPropagation(),H(!1);let R=S.dataTransfer.items,J=S.dataTransfer.files,ne=[];for(let Q=0,Ae;Ae=R[Q];++Q)Ae.webkitGetAsEntry().isFile&&ne.push(J[Q]);for(let Q=0;Q<ne.length;Q++)await j(ne[Q])};return addEventListener("dragenter",w),addEventListener("dragover",w),addEventListener("dragleave",y),addEventListener("drop",D),()=>{removeEventListener("dragenter",w),removeEventListener("dragover",w),removeEventListener("dragleave",y),removeEventListener("drop",D)}},[]),u(F,{children:[V&&t("div",{className:"pointer-events-none fixed top-0 left-0 z-20 flex h-full w-full select-none items-center justify-center backdrop-blur-sm",children:t("h1",{className:"text-3xl",children:"Th\u1EA3 file \u0111\u1EC3 g\u1EEDi"})}),m.length>0&&t("div",{className:"border-dark-lighten flex h-32 items-center gap-2 border-t px-4",children:m.map(y=>u("div",{className:"relative",children:[t("img",{className:"h-28 w-28 object-cover",src:y,alt:""}),t("button",{onClick:()=>E(m.filter(w=>w!==y)),className:"absolute top-1 right-1 flex h-4 w-4 items-center justify-center rounded-full bg-gray-100",children:t("i",{className:"bx bx-x text-dark text-lg"})})]},y))}),m.length===0&&!!n&&u("div",{className:"border-dark-lighten flex h-[76px] justify-between border-t p-4",children:[u("div",{children:[u("div",{className:"flex items-center gap-2",children:[t(Se,{}),u("p",{children:["Tr\u1EA3 l\u1EDDi tin nh\u1EAFn",(k==null?void 0:k.id)===n.author?" c\u1EE7a ch\xEDnh b\u1EA1n":""]})]}),n.typeMessage==="text"?t("p",{className:"max-w-[calc(100vw-65px)] overflow-hidden text-ellipsis whitespace-nowrap md:max-w-[calc(100vw-420px)]",children:n.content}):n.typeMessage==="image"?"H\xECnh \u1EA3nh":n.typeMessage==="sticker"?"Sticker":"Tin nh\u1EAFn \u0111\xE3 \u0111\u01B0\u1EE3c thu h\u1ED3i"]}),t("button",{onClick:()=>s&&s(null),children:t("i",{className:"bx bx-x text-3xl"})})]}),u("div",{className:`border-dark-lighten flex h-16 items-stretch gap-1 border-t px-4 ${e?"pointer-events-none select-none":""}`,children:[t("button",{onClick:()=>{var y;return(y=C.current)==null?void 0:y.click()},className:"text-primary flex flex-shrink-0 items-center text-2xl",children:t("i",{className:"bx bxs-image-add"})}),t("input",{ref:C,hidden:!0,className:"hidden",type:"file",accept:"image/*",onChange:O}),u("div",{className:"relative flex flex-shrink-0 items-center",children:[p&&t(Kt,{setIsOpened:x,onSelect:f}),t("button",{onClick:()=>x(!0),className:"flex items-center",children:t(Rt,{})})]}),u("form",{onSubmit:M,className:"flex flex-grow items-stretch gap-1",children:[u("div",{className:"relative flex flex-grow items-center",children:[t("input",{maxLength:1e3,disabled:e,ref:g,value:d,onChange:y=>{h(y.target.value)},onKeyDown:K,onPaste:Z,className:"h-9 w-full rounded-full pl-3 pr-10 outline-none",type:"text",placeholder:"Message..."}),t("button",{type:"button",onClick:()=>v(!0),className:"absolute right-2 top-1/2 -translate-y-1/2",children:t("i",{className:"bx bxs-smile text-primary text-2xl"})}),N&&t(le,{onClickAway:()=>v(!1),children:y=>t("div",{ref:y,className:"absolute bottom-full right-0",children:t(a.exports.Suspense,{fallback:t("div",{className:"flex h-[357px] w-[348px] items-center justify-center rounded-lg border-2 border-[#555453] bg-[#222222]",children:t(X,{})}),children:t(zt,{onSelect:w=>G(w.native)})})})})]}),c?t("div",{className:"ml-1 flex items-center",children:t(X,{width:"24px",height:"24px",color:"#0D90F3"})}):t("button",{className:"text-primary flex flex-shrink-0 items-center text-2xl",children:t("i",{className:"bx bxs-send"})})]})]}),t(te,{isOpened:T,setIsOpened:z,text:L,isError:!0})]})},Vt=({setIsOpened:e})=>{a.exports.useEffect(()=>{fetch(_+"/NhanVien/GetAllNguoiDung?PageSize=100000&PageIndex=1",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+(r==null?void 0:r.token)}}).then(g=>g.json()).then(g=>{g.success&&n(g.data.data)}).catch(g=>console.log(g))},[]),a.exports.useEffect(()=>{fetch(_+"/User/user-get-by-id-token?userId="+(r==null?void 0:r.id),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+(r==null?void 0:r.token)}}).then(g=>g.json()).then(g=>{console.log(g)}).catch(g=>console.log(g))},[]);const[i,n]=a.exports.useState([]),r=P(g=>g.currentUser),s=a.exports.useRef(null),[o,l]=a.exports.useState(!1),[d,h]=a.exports.useState(""),[c,b]=a.exports.useState(""),[m,E]=a.exports.useState([]),[p,x]=a.exports.useState(!1),[N,v]=a.exports.useState(""),T=Pe(),[z,L]=a.exports.useState(""),W=g=>{m.includes(g)?E(m.filter(C=>C!==g)):E([...m,g]),h("")},I=async g=>{var M;const C=(M=g.target.files)==null?void 0:M[0];if(!C)return;if(!C.type.startsWith("image")){v("File v\u1EEBa ch\u1ECDn kh\xF4ng ph\u1EA3i \u1EA3nh"),x(!0);return}const V=1024*1024*5;if(C.size>V){v("K\xEDch c\u1EE1 \u1EA3nh t\u1ED1i \u0111a l\xE0 5MB"),x(!0);return}const H=me(Ee,ve(C.name));await fe(H,C);const B=await ge(H);L(B)},k=async()=>{l(!0);const C=[...m,r==null?void 0:r.id].sort().map(B=>{const M=i.find(f=>(f==null?void 0:f.idNguoiDung)==B);return{id:""+(M==null?void 0:M.idNguoiDung),name:M==null?void 0:M.tenNguoiDung,avatar:(M==null?void 0:M.strNguoiDungAnhDinhKem)||null}}),V=se(Y(A,"room"),re("idMember","==",C.map(B=>B.id))),H=await ht(V);if(H.empty){const B=await ce(Y(A,"room"),{firstMessage:"",idMember:C.map(M=>M.id),nameMember:C.map(M=>M.name),listAvatarMember:[],timestamp:ie(),userPing:[],typeRoom:C.length==2?"private":"group",hostId:""+(r==null?void 0:r.id),nameGroup:C.length>2?c:C.filter(M=>M.id!==(r==null?void 0:r.id))[0].name,avatarMember:C.length>2?z:""});l(!1),e(!1),T(`/${B.id}`)}else e(!1),T(`/${H.docs[0].id}`),l(!1)};return t("div",{onClick:()=>e(!1),className:"fixed top-0 left-0 z-20 flex h-full w-full items-center justify-center bg-[#00000080]",children:u("div",{onClick:g=>g.stopPropagation(),className:"bg-neutral-300 mx-3 w-full max-w-[500px] overflow-hidden rounded-lg",children:[u("div",{className:"border-dark-lighten flex items-center justify-between border-b py-3 px-3",children:[t("div",{className:"flex-1"}),t("div",{className:"flex flex-1 items-center justify-center",children:t("h1",{className:"whitespace-nowrap text-center text-2xl",children:"T\u1EA1o cu\u1ED9c tr\xF2 chuy\u1EC7n"})}),t("div",{className:"flex flex-1 items-center justify-end",children:t("button",{onClick:()=>e(!1),className:"bg-dark-lighten flex h-8 w-8 items-center justify-center rounded-full",children:t("i",{className:"bx bx-x text-2xl"})})})]}),t("div",{className:"flex",children:t("input",{type:"text",value:d,className:"p-2 text-dark outline-none rounded m-5 w-full",placeholder:"T\xEAn ng\u01B0\u1EDDi d\xF9ng",onChange:g=>h(g.target.value)})}),t("div",{children:t("div",{className:"mx-5 bg-neutral-400 p-2 h-40 overflow-y-auto",children:m.map(g=>{const C=i.find(V=>(V==null?void 0:V.idNguoiDung)==g);return u("div",{className:"flex items-center mb-2",children:[t("img",{className:"h-8 w-8 flex-shrink-0 rounded-full object-cover mr-2",src:(C==null?void 0:C.strNguoiDungAnhDinhKem)||U,alt:""}),C.tenNguoiDung]})})})}),u(F,{children:[o&&t("div",{className:"absolute top-0 left-0 z-20 flex h-full w-full items-center justify-center bg-[#00000080]",children:t(X,{color:"#0D90F3"})}),t("div",{className:"flex h-96 flex-col items-stretch gap-2 overflow-y-auto py-2",children:i&&i.filter(g=>g.idNguoiDung!==(r==null?void 0:r.id)&&(g==null?void 0:g.tenNguoiDung.toLowerCase().includes(d.toLowerCase()))).map((g,C)=>u("div",{onClick:()=>W(g==null?void 0:g.idNguoiDung),className:"hover:bg-stone-400 flex cursor-pointer items-center gap-2 px-5 py-2 transition",children:[t("input",{className:"flex-shrink-0 cursor-pointer",type:"checkbox",checked:m.includes(g==null?void 0:g.idNguoiDung),readOnly:!0}),t("img",{className:"h-8 w-8 flex-shrink-0 rounded-full object-cover",src:(g==null?void 0:g.strNguoiDungAnhDinhKem)||U,alt:""}),t("p",{children:g==null?void 0:g.tenNguoiDung})]},C+Math.random()))}),u("div",{className:"border-dark-lighten border-t p-3",children:[m.length>1&&u("div",{className:"flex justify-between items-center mb-3",children:[t("input",{type:"text",value:c,className:"p-2 text-dark outline-none rounded",placeholder:"T\xEAn cu\u1ED9c tr\xF2 chuy\u1EC7n",onChange:g=>b(g.target.value)}),t("button",{onClick:()=>{var g;return(g=s.current)==null?void 0:g.click()},className:"bg-dark flex items-center gap-3 rounded-lg px-3 py-2 bg-blue-400 transition duration-300 hover:brightness-125",children:z?"\u0110\xE3 ch\u1ECDn \u1EA3nh":"Vui l\xF2ng ch\u1ECDn \u1EA3nh"}),t("input",{hidden:!0,className:"hidden",ref:s,type:"file",accept:"image/*",onChange:I})]}),t("div",{className:"flex justify-center items-center",children:t("button",{disabled:m.length===0||m.length>1&&!c||m.length>1&&!z,onClick:k,className:"bg-green-300 rounded-lg py-2 px-3 transition duration-300 hover:brightness-125 disabled:!brightness-[80%]",children:"T\u1EA1o cu\u1ED9c tr\xF2 chuy\u1EC7n"})})]})]}),t(te,{isOpened:p,setIsOpened:x,text:N,isError:!0})]})})};let Xe={};const Ht=e=>{const[i,n]=a.exports.useState(Xe[e]||null),[r,s]=a.exports.useState(!i),[o,l]=a.exports.useState(!1);return a.exports.useEffect(()=>{const d=xe(se(Y(A,"message"),re("idRoom","==",e),be("timestamp"),Ie(1)),h=>{var x,N,v,T,z,L,W,I,k,g;if(h.empty){n({lastMessageId:null,message:"No message recently"}),s(!1),l(!1);return}const c=(v=(N=(x=h.docs)==null?void 0:x[0])==null?void 0:N.data())==null?void 0:v.typeMessage;let b=c==="image"?"An image":c==="sticker"?"A sticker":c==="removed"?"Message removed":h.docs[0].data().content;const m=(L=(z=(T=h.docs[0])==null?void 0:T.data())==null?void 0:z.timeStamp)==null?void 0:L.seconds,E=ke(m?m*1e3:Date.now());b=b.length>30-E.length?`${b.slice(0,30-E.length)}...`:b;const p=`${b} \u2022 ${E}`;n({lastMessageId:(I=(W=h.docs)==null?void 0:W[0])==null?void 0:I.id,message:p}),Xe[e]={lastMessageId:(g=(k=h.docs)==null?void 0:k[0])==null?void 0:g.id,message:p},s(!1),l(!1)},h=>{console.log(h),n(null),s(!1),l(!0)});return()=>{d()}},[e]),{data:i,loading:r,error:o}},qt=({conversation:e,conversationId:i})=>{const n=P(o=>o.currentUser),{id:r}=ee(),{data:s}=Ht(i);return e.nameMember.length===2?u(oe,{to:`/${i}`,className:`hover:bg-stone-400 relative flex items-stretch gap-2 py-2 px-5 transition duration-300 ${i===r?"bg-stone-500":""}  ${(e==null?void 0:e.seen)&&!(e==null?void 0:e.seen.includes(""+(n==null?void 0:n.id)))?"bg-blue-500":""}`,children:[t(Ve,{uid:e.idMember.find(o=>o!=(n==null?void 0:n.id)),size:40}),u("div",{className:"flex flex-grow flex-col justify-center gap-1 py-1",children:[t("p",{className:"max-w-[240px] flex-grow overflow-hidden text-ellipsis whitespace-nowrap",children:e.nameMember.find(o=>o!==(n==null?void 0:n.ten))}),t("p",{className:"max-w-[240px] flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-sm text-gray-600",children:s==null?void 0:s.message})]}),t("div",{children:(e==null?void 0:e.seen)&&!(e==null?void 0:e.seen.includes(""+(n==null?void 0:n.id)))?t("i",{className:"bx bxs-bullseye"}):""})]}):u(oe,{to:`/${i}`,className:`hover:bg-stone-400 relative flex items-stretch gap-2 py-2 px-5 transition duration-300 ${i===r?"bg-stone-500":""} ${(e==null?void 0:e.seen)&&!(e==null?void 0:e.seen.includes(""+(n==null?void 0:n.id)))?"bg-blue-500":""}`,children:[t("img",{className:"h-12 w-12 flex-shrink-0 rounded-full object-cover",src:e.avatarMember,alt:""}),u("div",{className:"flex flex-grow flex-col justify-center gap-1 py-1",children:[t("p",{className:"max-w-[240px] flex-grow overflow-hidden text-ellipsis whitespace-nowrap",children:e.nameGroup}),t("p",{className:"max-w-[240px] flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-sm text-gray-600",children:s==null?void 0:s.message})]}),t("div",{children:(e==null?void 0:e.seen)&&!(e==null?void 0:e.seen.includes(""+(n==null?void 0:n.id)))?t("i",{className:"bx bxs-bullseye"}):""})]})},Qe=()=>{const e=P(p=>p.currentUser),[i,n]=a.exports.useState(""),[r,s]=a.exports.useState(!1),[o,l]=a.exports.useState(!1),{data:d,error:h,loading:c}=De("conversations",se(Y(A,"room"),re("idMember","array-contains",e==null?void 0:e.id.toString())));(()=>{const p=localStorage.getItem("pingToken")||null;p&&(d==null||d.docs.map(x=>{var N,v,T;Array.isArray((N=x.data())==null?void 0:N.userPing)||q($(A,"room",x.id),{userPing:[p]}),Array.isArray((v=x.data())==null?void 0:v.userPing)&&!x.data().userPing.includes(p)&&q($(A,"room",x.id),{userPing:[...(T=x.data())==null?void 0:T.userPing,p]})}))})();const m=()=>{const p=localStorage.getItem("pingToken")||null;p&&(d==null||d.docs.map(x=>{var N,v;Array.isArray((N=x.data())==null?void 0:N.userPing)&&x.data().userPing.includes(p)&&q($(A,"room",x.id),{userPing:(v=x.data())==null?void 0:v.userPing.filter(T=>T!=p)})})),localStorage.clear(),window.location.reload()},E=ye();return u(F,{children:[u("div",{className:`border-dark-lighten h-screen flex-shrink-0 overflow-y-auto overflow-x-hidden border-r ${E.pathname!=="/"?"hidden w-[350px] md:!block":"w-full md:!w-[350px]"}`,children:[u("div",{className:"border-dark-lighten flex h-20 items-center justify-between border-b px-6",children:[t(oe,{to:"/",className:"flex items-center gap-1",children:t("img",{className:"w-40",src:"/logo.png",alt:""})}),u("div",{className:"flex items-center gap-1",children:[t("button",{onClick:()=>l(!0),className:"h-8 w-8 rounded-full",children:t("i",{className:"bx bxs-edit text-xl"})}),t(le,{onClickAway:()=>s(!1),children:p=>u("div",{ref:p,className:"relative z-10",children:[t("img",{onClick:()=>s(x=>!x),className:"h-8 w-8 cursor-pointer rounded-full object-cover",src:!!(e==null?void 0:e.nguoiDung_AnhDinhKem)&&(e==null?void 0:e.nguoiDung_AnhDinhKem.length)&&(e==null?void 0:e.nguoiDung_AnhDinhKem[0].url)?we(e==null?void 0:e.nguoiDung_AnhDinhKem[0].url):U,alt:""}),u("div",{className:`border-dark-lighten bg-white absolute top-full right-0 flex w-max origin-top-right flex-col items-stretch overflow-hidden rounded-md border py-1 shadow-lg transition-all duration-200 ${r?"visible scale-100 opacity-100":"invisible scale-0 opacity-0"}`,children:[u("p",{className:"p-2",children:["T\xEAn:",e==null?void 0:e.ten]}),u("p",{className:"p-2",children:["Email:",e==null?void 0:e.email]}),u("p",{className:"p-2",children:["TK:",e==null?void 0:e.taiKhoan]}),u("button",{onClick:()=>m(),className:"hover:bg-dark-lighten flex items-center gap-1 px-3 py-1 transition duration-300",children:[t("i",{className:"bx bx-log-out text-xl"}),t("span",{className:"whitespace-nowrap",children:"\u0110\u0103ng xu\u1EA5t"})]})]})]})})]})]}),c?t("div",{className:"my-6 flex justify-center",children:t(X,{})}):h?t("div",{className:"my-6 flex justify-center",children:t("p",{className:"text-center",children:"C\xF3 l\u1ED7i x\u1EA3y ra"})}):(d==null?void 0:d.empty)?u("div",{className:"my-6 flex flex-col items-center justify-center",children:[t("p",{className:"text-center",children:"Kh\xF4ng c\xF3 cu\u1ED9c tr\xF2 chuy\u1EC7n n\xE0o"}),t("button",{onClick:()=>l(!0),className:"text-primary text-center",children:"T\u1EA1o cu\u1ED9c tr\xF2 chuy\u1EC7n m\u1EDBi"})]}):u("div",{children:[t("input",{type:"text",value:i,className:"p-2 text-dark outline-none rounded m-5",placeholder:"T\xECm ki\u1EBFm",onChange:p=>n(p.target.value)}),d==null?void 0:d.docs.filter(p=>p.data().idMember>2?p.data().nameGroup.includes(i.toLowerCase()):p.data().nameMember.filter(x=>x!=e.ten)[0].toLowerCase().includes(i.toLowerCase())).sort((p,x)=>{var N,v;return new Date(((N=x.data().timestamp)==null?void 0:N.seconds)*1e3).getTime()-new Date(((v=p.data().timestamp)==null?void 0:v.seconds)*1e3).getTime()}).map(p=>t(qt,{conversation:p.data(),conversationId:p.id},p.id))]})]}),o&&t(Vt,{setIsOpened:l})]})},Wt=()=>{const{id:e}=ee(),{data:i,loading:n,error:r}=We(`room-${e}`,$(A,"room",e)),s=i==null?void 0:i.data(),o=P(N=>N.currentUser),[l,d]=a.exports.useState(0),[h,c]=a.exports.useState(null),[b,m]=a.exports.useState([""]),[E,p]=a.exports.useState(null),x=N=>{b.includes(N)?m(b.filter(v=>v!==N)):m([...b,N])};return a.exports.useEffect(()=>{E==!1&&m([""])},[E]),u("div",{className:"flex",children:[t(Qe,{}),t("div",{className:"flex h-screen flex-grow flex-col items-stretch",children:n?u(F,{children:[t("div",{className:"border-dark-lighten h-20 border-b"}),t("div",{className:"flex-grow"})]}):!s||r||!s.idMember.includes(o.id.toString())?u("div",{className:"flex h-full w-full flex-col items-center justify-center gap-6",children:[t("img",{className:"h-32 w-32 object-cover",src:"/error.svg",alt:""}),t("p",{className:"text-center text-lg",children:"Kh\xF4ng t\xECm th\u1EA5y cu\u1ED9c tr\xF2 chuy\u1EC7n"})]}):u(F,{children:[t(Ft,{conversation:s}),t(Pt,{replyInfo:h,setReplyInfo:c,inputSectionOffset:l,conversation:s}),t("div",{style:{visibility:E?"visible":"hidden",height:"160px",overflow:"auto"},className:"m-2",children:s.nameMember.map((N,v)=>u("div",{onClick:()=>x(N),className:"hover:bg-stone-400 flex cursor-pointer items-center gap-2 px-5 py-2 transition",children:[t("input",{className:"flex-shrink-0 cursor-pointer",type:"checkbox",checked:b.includes(N),readOnly:!0}),t("p",{children:N})]},v))}),t(Gt,{setInputSectionOffset:d,replyInfo:h,setTagShow:p,tagUser:b,setReplyInfo:c,conversation:s,disabled:!1})]})})]})},Jt=()=>u("div",{className:"flex",children:[t(Qe,{}),t("div",{className:"hidden flex-grow flex-col items-center justify-center gap-3 md:!flex",children:t("h1",{className:"text-center",children:"Ch\u1ECDn m\u1ED9t cu\u1ED9c tr\xF2 chuy\u1EC7n \u0111\u1EC3 b\u1EAFt \u0111\u1EA7u"})})]}),Ue=({children:e})=>{const i=P(l=>l.currentUser),n=ye(),r=P(l=>l.setCurrentUser),[s,o]=pt();return s.get("vtech_token")&&fetch(_+"/User/my-profile",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s.get("vtech_token")}}).then(l=>l.json()).then(l=>{if(l.success){r(l.data),l.data.token=s.get("vtech_token"),localStorage.setItem("user",JSON.stringify(l.data));var d=new Date,h=new Date(d.getTime()+864e5);localStorage.setItem("expired",JSON.stringify(h.getTime()))}}).catch(l=>console.log(l)),i?t(F,{children:e}):t(Te,{to:`/sign-in?redirect=${encodeURIComponent(n.pathname+n.search)}`})},Yt=()=>{const e=ye();return Object.fromEntries(new URLSearchParams(e.search).entries())},Zt=()=>{const{redirect:e}=Yt(),i=P(x=>x.currentUser),n=P(x=>x.setCurrentUser),[r,s]=a.exports.useState(!1),[o,l]=a.exports.useState(""),[d,h]=a.exports.useState(""),[c,b]=a.exports.useState(""),[m,E]=a.exports.useState(!1),p=()=>{s(!0),fetch(_+"/User/authenticate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matKhau:c,taiKhoan:d})}).then(x=>x.json()).then(x=>{if(x.success){localStorage.setItem("user",JSON.stringify(x.data));var N=new Date,v=new Date(N.getTime()+864e5);return localStorage.setItem("expired",JSON.stringify(v.getTime())),n(x.data)}else l(x.message),E(!0)}).catch(x=>console.log(x)),s(!1)};return i?t(Te,{to:e||"/"}):u(F,{children:[t("div",{className:"mx-[5vw] my-5 flex justify-center lg:my-10",children:u("div",{className:"w-full max-w-[1100px]",children:[t("div",{className:"flex justify-between",children:t("div",{className:"flex items-center gap-2",children:t("img",{className:"w-40",src:"/logo.png",alt:""})})}),u("div",{className:"flex flex-col-reverse gap-10 md:mt-5 md:flex-row md:gap-5 lg:mt-10",children:[t("div",{className:"flex-1",children:t("img",{className:"h-auto w-full",src:"/illustration.svg",alt:""})}),u("div",{className:"mt-12 flex flex-1 flex-col items-center gap-4 md:items-start lg:mt-24",children:[t("input",{type:"text",value:d,className:"p-2 text-dark outline-none rounded",placeholder:"Username",onChange:x=>h(x.target.value)}),t("input",{type:"password",value:c,className:"p-2 text-dark outline-none rounded",placeholder:"Password",onChange:x=>b(x.target.value)}),t("button",{disabled:r,onClick:p,className:"flex px-10 cursor-pointer items-center gap-3 rounded-md bg-blue-300 p-3 text-black transition duration-300 hover:brightness-90 disabled:!cursor-default disabled:!brightness-75",children:t("span",{children:"\u0110\u0103ng nh\u1EADp"})})]})]})]})}),t(te,{isOpened:m,setIsOpened:E,text:o,isError:!0})]})},Xt=()=>{const e=P(l=>l.currentUser),i=P(l=>l.setCurrentUser),[n,r]=a.exports.useState({title:"",body:""}),[s,o]=a.exports.useState(!1);return vt(),a.exports.useEffect(()=>{const l=localStorage.getItem("expired")||"0";new Date().getTime()>parseInt(l)&&localStorage.clear()},[]),kt().then(l=>{var d,h;o(!0),r({title:(d=l==null?void 0:l.notification)==null?void 0:d.title,body:(h=l==null?void 0:l.notification)==null?void 0:h.body})}).catch(l=>console.log("failed: ",l)),a.exports.useEffect(()=>{const l=localStorage.getItem("user")||null;if(l){const d=JSON.parse(l);i(d)}else i(null)},[]),typeof e=="undefined"?t("div",{className:"flex min-h-screen items-center justify-center",children:t(mt,{})}):u(F,{children:[u(ft,{children:[t(Ne,{index:!0,element:t(Ue,{children:t(Jt,{})})}),t(Ne,{path:"sign-in",element:t(Zt,{})}),t(Ne,{path:":id",element:t(Ue,{children:t(Wt,{})})})]}),t(te,{isOpened:s,setIsOpened:o,text:n.body,title:n.title})]})};gt.render(t(xt,{children:t(Xt,{})}),document.getElementById("root"));
